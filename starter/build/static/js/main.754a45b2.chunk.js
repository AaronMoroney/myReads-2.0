(this["webpackJsonpnd0191-myreads-starter"]=this["webpackJsonpnd0191-myreads-starter"]||[]).push([[0],{11:function(e,t,s){},55:function(e,t,s){},65:function(e,t,s){"use strict";s.r(t);var c=s(0),a=s.n(c),r=s(27),o=s.n(r),l=s(12),n=(s(55),s(3));s(11);const i=Object(c.createContext)([]),j="https://reactnd-books-api.udacity.com";let d=localStorage.token;d||(d=localStorage.token=Math.random().toString(36).substr(-8));const b={Accept:"application/json",Authorization:d},h=()=>fetch("".concat(j,"/books"),{headers:b}).then((e=>e.json())).then((e=>e.books));var u=s(1);var O=e=>{let{setIsEditing:t,setBookGoal:s,handleSaveGoalSettings:c,bookGoal:a}=e;return Object(u.jsx)("div",{className:"modal-overlay",onClick:()=>{t(!1)},children:Object(u.jsx)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{onClick:()=>{s((e=>e-1))},children:"-"}),Object(u.jsx)("input",{type:"text","aria-label":"Book goal",value:a,readOnly:!0}),Object(u.jsx)("button",{onClick:()=>{s((e=>e+1))},children:"+"}),Object(u.jsx)("button",{className:"button-modal",onClick:c,children:"Save"})]})})})},x=s(39);s(57);var m=e=>{let{value:t,bookGoal:s}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(x.a,{value:t===1/0?0:t,circleRatio:.5,styles:Object(x.b)({pathColor:"rgba(248, 191, 48, ".concat(100,")"),rotation:.75,strokeLinecap:"round",trailColor:"#eee"}),children:Object(u.jsxs)("div",{className:"progress-bar-info",children:[Object(u.jsx)("h2",{className:"progress-bar-info-title",children:"".concat(t===1/0?0:t,"%")}),Object(u.jsx)("p",{children:"completed of  ".concat(s," book goal")})]})})})},v=s(45),p=s.n(v);var g=e=>{let{handleOpenEdit:t}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("header",{className:"goal-header",children:[Object(u.jsxs)("div",{className:"goal-header-text",children:[Object(u.jsx)("h2",{className:"header-title",children:" Reading Goals"}),Object(u.jsx)("p",{children:"complete books, and see your stats soar!"})]}),Object(u.jsx)("button",{className:"button",onClick:t,children:Object(u.jsx)(p.a,{})})]})})},k=s(47),f=s.n(k);const y={angle:90,spread:360,startVelocity:40,elementCount:"175",dragFriction:.12,duration:3e3,stagger:3,width:"10px",height:"10px",perspective:"500px",colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"]};var N=e=>{let{achievedValue:t}=e;return Object(u.jsx)(f.a,{active:100===t,config:y})};var S=()=>{const[e,t]=Object(c.useState)(!1),[s,a]=Object(c.useState)((()=>{let e=localStorage.getItem("goal");return null===e?0:JSON.parse(e)})()),[r,o]=Object(c.useState)(0),{read:l}=Object(c.useContext)(i),n=((e,t)=>{if(!e||0===t)return 0;const s=null===e||void 0===e?void 0:e.filter((e=>"read"===e.shelf));return Math.min(100,Math.round(s.length/t*100))})(l,s);return Object(c.useEffect)((()=>{o(n)}),[n]),Object(u.jsxs)("div",{className:"bookshelf goal-background",children:[Object(u.jsx)(g,{handleOpenEdit:()=>{t(!0)}}),Object(u.jsxs)("div",{className:"goal-container",children:[e&&Object(u.jsx)(O,{setIsEditing:t,setBookGoal:a,handleSaveGoalSettings:()=>{localStorage.setItem("goal",s),o(n),t(!1)},bookGoal:s}),Object(u.jsx)(N,{achievedValue:r}),Object(u.jsx)("section",{className:"progress-container",children:Object(u.jsx)(m,{value:n,bookGoal:s})})]})]})};function C(){const{setShelfState:e}=Object(c.useContext)(i),t=Object(c.useCallback)((async(t,s)=>{await((e,t)=>fetch("".concat(j,"/books/").concat(e.id),{method:"PUT",headers:{...b,"Content-Type":"application/json"},body:JSON.stringify({shelf:t})}).then((e=>e.json())))(t,s);let c=await h();await e(c)}),[e]);return Object(c.useMemo)((()=>({onUpdateSelector:t})),[t])}function R(){return Object(u.jsx)("div",{className:"book-shelf-changer-spinner",children:Object(u.jsx)("div",{className:"spinner"})})}var w=Object(c.memo)((e=>{let{book:t,shelf:s,showAlert:a}=e;const{read:r,wantToRead:o,currentlyReading:l}=Object(c.useContext)(i),[n,j]=Object(c.useState)(""),[d,b]=Object(c.useState)(!1),{onUpdateSelector:h}=C();Object(c.useEffect)((()=>{n&&(async()=>{b(!0);try{await h(t,n),a&&a()}catch(e){console.error("Error updating shelf:",e)}finally{b(!1)}})()}),[t,n,h,a]);const O=[...o,...r,...l].find((e=>e.id===t.id));return d?Object(u.jsx)(R,{}):Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"book-shelf-changer",children:Object(u.jsxs)("select",{value:O?O.shelf:"none",onChange:async e=>{j(e.target.value)},children:[Object(u.jsx)("option",{value:"none",children:"Move to..."}),Object(u.jsx)("option",{value:"currentlyReading",children:"Currently Reading"}),Object(u.jsx)("option",{value:"wantToRead",children:"Want to Read"}),Object(u.jsx)("option",{value:"read",children:"Read"})]})})})}));var T=Object(c.memo)((e=>{let{properties:t}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"book",children:[Object(u.jsxs)("div",{className:"book-top",children:[Object(u.jsx)(l.b,{to:"/books/".concat(t.id),state:{properties:t},children:Object(u.jsx)("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:'url("'.concat(t.imageLinks.smallThumbnail,'")')}})}),Object(u.jsx)("div",{children:Object(u.jsx)(w,{book:t,shelf:t.shelf})})]}),Object(u.jsx)("div",{className:"book-title",children:t.title}),Object(u.jsx)("div",{className:"book-authors",children:t.authors})]})})}));var I=e=>{let{title:t,isVisible:s}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"alert ".concat(s?"show":""),children:" '".concat(t,"' has been successfully moved!")})})};var F=e=>{let{properties:t}=e;const{showAlert:s,isVisible:a}=function(){const[e,t]=Object(c.useState)(""),s=Object(c.useCallback)((()=>{t(!0);const e=setTimeout((()=>{t(!1)}),3e3);return()=>clearTimeout(e)}),[]);return Object(c.useMemo)((()=>({showAlert:s,isVisible:e})),[s,e])}();return Object(u.jsx)(u.Fragment,{children:Object(u.jsxs)("div",{className:"book",children:[Object(u.jsxs)("div",{className:"book-top",children:[Object(u.jsx)("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:'url("'.concat(t.imageLinks.smallThumbnail,'")')}}),Object(u.jsx)("div",{children:Object(u.jsx)(w,{book:t,shelf:t.shelf,showAlert:s})})]}),Object(u.jsx)("div",{className:"book-title",children:t.title}),Object(u.jsx)("div",{className:"book-authors",children:t.authors}),Object(u.jsxs)("div",{className:"book-authors",children:[t.pageCount," pages"]}),Object(u.jsxs)("div",{className:"book-authors",children:["published by ",t.publisher]}),Object(u.jsx)(I,{title:t.title,shelf:t.shelf,isVisible:a})]})})};var E=Object(c.memo)((e=>{let{shelfName:t,properties:s}=e;return Object(u.jsx)("div",{children:Object(u.jsxs)("div",{className:"bookshelf",children:[Object(u.jsx)("h2",{className:"bookshelf-title",children:t}),Object(u.jsx)("div",{className:"bookshelf-books",children:Object(u.jsx)("ol",{className:"books-grid",children:s.map((e=>Object(u.jsx)("li",{children:Object(u.jsx)(T,{properties:e})},e.id)))})})]})})}));var M=()=>Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"open-search",children:Object(u.jsx)(l.b,{to:"/search",children:"Add a book"})})});var A=()=>{const{currentlyReading:e,wantToRead:t,read:s}=Object(c.useContext)(i);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"list-books",children:[Object(u.jsx)("div",{className:"list-books-title",children:Object(u.jsx)("h1",{children:"MyReads"})}),Object(u.jsx)("div",{className:"list-books-content",children:Object(u.jsxs)("div",{children:[Object(u.jsx)(E,{shelfName:"Currently Reading",properties:e}),Object(u.jsx)(E,{shelfName:"Want To read",properties:t}),Object(u.jsx)(E,{shelfName:"Read",properties:s}),Object(u.jsx)("div",{className:"widget-container",children:Object(u.jsx)(S,{})})]})})]}),Object(u.jsx)(M,{})]})};var G=e=>{let{result:t,errorState:s}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"search-books-results",children:Object(u.jsx)("ol",{className:"books-grid",children:s?Object(u.jsx)("p",{children:"due to API Limitations, there are no results for your query"}):t.map((e=>Object(u.jsx)(T,{properties:e},e.id)))})})})};var Q=e=>{let{handleInputChange:t,query:s}=e;return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"search-books",children:Object(u.jsxs)("div",{className:"search-books-bar",children:[Object(u.jsx)(l.b,{onClick:()=>localStorage.removeItem("storedQuery"),to:"/",className:"close-search",children:"Close"}),Object(u.jsx)("div",{className:"search-books-input-wrapper",children:Object(u.jsx)("input",{onChange:t,type:"text",placeholder:s||"Search by title, author, or ISBN",value:s||""})})]})})})};function V(){const[e,t]=Object(c.useState)(localStorage.getItem("storedQuery")),[s,a]=Object(c.useState)([]),[r,o]=Object(c.useState)(!1),l=Object(c.useCallback)((e=>{const s=e.target.value;t(s),localStorage.setItem("storedQuery",s)}),[]),n=Object(c.useCallback)((async()=>{null!==e&&""!==e&&((e,t)=>fetch("".concat(j,"/search"),{method:"POST",headers:{...b,"Content-Type":"application/json"},body:JSON.stringify({query:e,maxResults:t})}).then((e=>e.json())).then((e=>e.books)))(e).then((e=>{Array.isArray(e)?(a(e),o(!1)):(a([]),o(!0))})).catch((e=>{console.error("error",Error)}))}),[e]);return Object(c.useMemo)((()=>({onSearch:n,onQueryType:l,setQuery:t,result:s,errorState:r,query:e})),[n,t,l,s,r,e])}var q=()=>{const{onSearch:e,setQuery:t,result:s,errorState:a,query:r,onQueryType:o}=V();return Object(c.useEffect)((()=>{e(r)}),[e,r]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(Q,{setQuery:t,handleInputChange:e=>{o(e)},query:r}),Object(u.jsx)(G,{result:s,errorState:a})]})};var B=()=>{var e;const t=Object(n.o)(),s=null===(e=Object(n.m)().state)||void 0===e?void 0:e.properties;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("div",{className:"list-books",children:[Object(u.jsx)(l.b,{onClick:()=>t(-1),className:"close-search",children:"back"}),Object(u.jsx)("div",{className:"list-books-title",children:Object(u.jsx)("h1",{children:"MyReads"})}),Object(u.jsx)("div",{className:"bookshelf",children:Object(u.jsx)("div",{className:"bookshelf-books",children:Object(u.jsx)("ol",{className:"books-grid",children:s&&Object(u.jsx)(F,{properties:s})})})})]}),Object(u.jsx)(M,{})]})};var J=function(){const[e,t]=Object(c.useState)([]);Object(c.useEffect)((()=>{!async function(){let e=await h();t(e)}()}),[]);const{read:s,wantToRead:a,currentlyReading:r}=(e=>{const[t,s]=Object(c.useState)([]),[a,r]=Object(c.useState)([]),[o,l]=Object(c.useState)([]);return Object(c.useEffect)((()=>{s(null===e||void 0===e?void 0:e.filter((e=>"read"===e.shelf))),r(null===e||void 0===e?void 0:e.filter((e=>"currentlyReading"===e.shelf))),l(null===e||void 0===e?void 0:e.filter((e=>"wantToRead"===e.shelf)))}),[e]),Object(c.useMemo)((()=>({read:t,currentlyReading:a,wantToRead:o,setRead:s,setCurrentlyReading:r,setWantToRead:l})),[t,s,o,l,a,r])})(e),o=Object(c.useMemo)((()=>({read:s,wantToRead:a,currentlyReading:r,setShelfState:t})),[s,r,a,t]);return Object(u.jsx)(i.Provider,{value:o,children:Object(u.jsx)("div",{className:"app",children:Object(u.jsxs)(n.c,{children:[Object(u.jsx)(n.a,{exact:!0,path:"/",element:Object(u.jsx)(A,{})}),Object(u.jsx)(n.a,{exact:!0,path:"/search",element:Object(u.jsx)(q,{})}),Object(u.jsx)(n.a,{exact:!0,path:"/books/:id",element:Object(u.jsx)(B,{})})]})})})};o.a.render(Object(u.jsx)(l.a,{children:Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(J,{})})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.754a45b2.chunk.js.map